<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Video Form</title>
  <style>
    :root{
      --radiusBtn: 14px;
      --glass: rgba(255,255,255,.14);
      --glass2: rgba(255,255,255,.10);
      --border: rgba(255,255,255,.18);
      --shadow: 0 18px 40px rgba(0,0,0,.35);
    }

    /* âœ… Ù…Ù†Ø¹ ØªÙ…Ø±ÙŠØ± Ø§Ù„ØµÙØ­Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙŠÙƒÙˆÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙÙ‚Ø·) */
    html, body{
      margin:0; height:100%;
      overflow:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:#0b0b0d; color:#fff;
    }

    .stage{
      position:relative;
      height:100vh; width:100%;
      overflow:hidden;
      background:#000;
    }

    video{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      background:#000;
      transform: scale(1.02);
      filter: contrast(1.02) saturate(1.06);
    }

    .shade{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 700px at 50% 20%, rgba(0,0,0,.15), rgba(0,0,0,.55)),
        linear-gradient(180deg, rgba(0,0,0,.65) 0%, rgba(0,0,0,.20) 45%, rgba(0,0,0,.75) 100%);
      pointer-events:none;
    }

    .overlay{
      position:absolute; inset:0;
      display:flex;
      flex-direction:column;
      padding:14px;
      gap:10px;
      overflow:hidden; /* âœ… overlay Ù„Ø§ ÙŠØªØ­Ø±Ùƒ */
    }

    /* âœ… Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø«Ø§Ø¨Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§ + Ù…Ù†Ø®ÙØ¶ Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
    .topBar{
      flex: 0 0 auto;
      position: relative; /* Ù„ÙŠØ³ sticky Ù„Ø£Ù†Ù†Ø§ Ù…Ù†Ø¹Ù†Ø§ scroll Ù„Ù„ØµÙØ­Ø© */
      z-index: 5;
      margin-top: 10px;   /* âœ… Ø®ÙØ¶ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
      padding:10px 10px 12px;
      border-radius: 16px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .title{
      font-size:20px;
      line-height:1.25;
      font-weight:900;
      letter-spacing:.2px;
      text-shadow: 0 4px 24px rgba(0,0,0,.65);
    }

    /* âœ… Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙ‚Ø· Ø¯Ø§Ø®Ù„ panel */
    .bottomSheet{
      flex: 1 1 auto;
      display:flex;
      align-items:flex-end;
      overflow:hidden;
    }

    .panel{
      width:100%;
      max-height: calc(100vh - 140px); /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø¹Ù†ÙˆØ§Ù† */
      overflow:auto;                  /* âœ… Ù‡Ù†Ø§ ÙÙ‚Ø· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
      padding:12px 0 0;
    }

    .choices{
      display:flex;
      flex-direction:column;
      gap:10px;
      padding-bottom: 6px;
    }

    .btn{
      width:100%;
      border:1px solid var(--border);
      background: linear-gradient(180deg, var(--glass), var(--glass2));
      color:#fff;
      border-radius: var(--radiusBtn);
      padding:14px 14px;
      font-size:16px;
      font-weight:850;
      cursor:pointer;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      transition: transform .12s ease, border-color .12s ease;
      text-align:left;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.28); }
    .btn:active{ transform: translateY(0px) scale(.99); }

    .btn.primary{
      background: linear-gradient(180deg, rgba(255,255,255,.22), rgba(255,255,255,.12));
    }

    .opt{ display:flex; align-items:center; gap:12px; }
    .badge{
      min-width:34px; height:34px;
      border-radius:12px;
      display:inline-flex;
      align-items:center; justify-content:center;
      font-weight:950;
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.22);
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
    }
    .label{ font-weight:850; letter-spacing:.2px; }

    .input{
      width:100%;
      border-radius: var(--radiusBtn);
      border:1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.30);
      color:#fff;
      padding:14px 14px;
      font-size:16px;
      outline:none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
    }

    .formCard{
      background: linear-gradient(180deg, #7a5636 0%, #5f432a 100%);
      min-height:100vh;
      padding:22px 18px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:12px;
    }
    .formTitle{
      font-size:18px;
      font-weight:950;
      line-height:1.35;
      margin-bottom:6px;
    }
    .grid{ display:grid; grid-template-columns:1fr; gap:10px; }

    .bar{
      position:fixed; top:10px; left:10px; right:10px;
      display:flex; justify-content:space-between; gap:10px;
      z-index:10;
      font-size:12px; opacity:.95;
      text-shadow: 0 2px 12px rgba(0,0,0,.6);
      pointer-events:none;
    }
    .bar span{ pointer-events:auto; }
    .pill{
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.14);
      padding:6px 10px;
      border-radius:999px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* âœ… Ø²Ø± OK Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ */
    .okBtn{
      display:none;
      width:100%;
      border-radius: var(--radiusBtn);
      padding:14px 16px;
      background: rgba(34,197,94,.95);
      color:#07160a;
      font-size:18px;
      font-weight:950;
      border: 0;
      cursor:pointer;
      box-shadow: var(--shadow);
      text-align:center;
    }

    .small{ font-size:12px; opacity:.85; padding-top:2px; }

    @media (min-width: 760px){
      .overlay{ padding:18px 22px; }
      .title{ font-size:26px; }
      .panel{ max-width: 560px; }
      .bottomSheet{ justify-content:flex-start; }
      .topBar{ margin-top: 6px; } /* desktop Ø£Ù‚Ù„ */
    }
  </style>
</head>

<body>
  <div class="bar">
    <span class="pill" id="stepPill">Step 1/11</span>
    <span class="pill" id="savePill">Not sent</span>
  </div>

  <div id="app"></div>

<script>
  const VIDEO_URLS = {
    // âœ… ØªÙ… ÙˆØ¶Ø¹ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù‡Ù†Ø§
    v1: "https://raw.githubusercontent.com/linkerdon/Video1/main/video.mp4",

    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø®Ø·ÙˆØ§Øª ÙƒÙ…Ø§ Ù‡ÙŠ (ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹)
    v2: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v4: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v5: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v6: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v7: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v8: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v9: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v10:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    v11:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
  };

  const WEBHOOK_URL = ""; // Ø¶Ø¹ Webhook Ù‡Ù†Ø§ Ù„Ùˆ ØªØ±ÙŠØ¯

  const steps = [
    { id:"s1", type:"video_button", video: VIDEO_URLS.v1, title:"", button:"CONTINUER" },

    { id:"s2", type:"video_choices", video: VIDEO_URLS.v2,
      title:"Dans quelle rÃ©gion vis-tu ? ğŸŒ",
      key:"region",
      choices:[
        ["A","Europe"],
        ["B","AMERIQUE DU NORD/SUD"],
        ["C","DOM-TOM"],
        ["D","Asie"],
        ["E","AFRIQUE"],
        ["F","OCÃ‰ANIE"]
      ]
    },

    { id:"s3", type:"contact_form",
      title:"Avant la prochaine question, quels sont tes coordonnÃ©es afin que nous puissions te recontacter ?",
      button:"Prochaine Ã©tape",
      fields:[
        { key:"name", label:"Nom", placeholder:"Votre nom", required:true },
        { key:"email", label:"Email", placeholder:"nom@email.com", required:true },
        { key:"phone", label:"TÃ©lÃ©phone (avec indicatif pays)", placeholder:"+33 6 00 00 00 00", required:true },
      ]
    },

    { id:"s4", type:"video_choices", video: VIDEO_URLS.v4,
      title:"Sur quels rÃ©seaux te trouves-tu actuellement?",
      key:"reseaux",
      choices:[
        ["A","Instagram"],
        ["B","tiktok"],
        ["C","les deux"],
        ["D","Aucun"],
      ]
    },

    { id:"s5", type:"video_input", video: VIDEO_URLS.v5,
      title:"Quel est ton @pseudo?",
      key:"pseudo",
      placeholder:"Ã‰crivez ici...",
    },

    { id:"s6", type:"video_input", video: VIDEO_URLS.v6,
      title:"Quel est ton domaine d'activitÃ©/Niche ?",
      key:"niche",
      placeholder:"Quel est ton domaine d'activitÃ©/Niche ?",
    },

    { id:"s7", type:"video_choices", video: VIDEO_URLS.v7,
      title:"Depuis combien de temps ?",
      key:"duree",
      choices:[
        ["A","Moins de 1 an"],
        ["B","Plus de 1 an"],
      ]
    },

    { id:"s8", type:"video_input", video: VIDEO_URLS.v8,
      title:"Explique ton problÃ¨me",
      key:"probleme",
      placeholder:"Ã‰crivez ici...",
      multiline:true
    },

    { id:"s9", type:"video_choices", video: VIDEO_URLS.v9,
      title:"TON CHIFFRE D'AFFAIRE ?",
      key:"ca",
      choices:[
        ["A","â‚¬0-â‚¬5k"],
        ["B","â‚¬5k-â‚¬10k"],
        ["C","â‚¬10k-â‚¬50k"],
        ["D","â‚¬50k +"],
      ]
    },

    { id:"s10", type:"video_choices", video: VIDEO_URLS.v10,
      title:"Quel serait ton budget?",
      key:"budget",
      choices:[
        ["A","1000â‚¬ -1500â‚¬"],
        ["B","1500â‚¬ - 3000â‚¬"],
        ["C","plus de 3000â‚¬"],
      ]
    },

    /* âœ… Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©: Ø§Ø®ØªÙŠØ§Ø± Ø«Ù… ÙŠØ¸Ù‡Ø± Ø²Ø± OK */
    { id:"s11", type:"video_choices_ok", video: VIDEO_URLS.v11,
      title:"Appuie ensuite sur ok",
      key:"timing",
      choices:[
        ["A","DÃ¨s que possible"],
        ["B","D'ici 1 Ã  2 semaines"],
        ["C","Pas encore prÃªt.e Ã  commencer"],
      ]
    },
  ];

  const app = document.getElementById("app");
  const stepPill = document.getElementById("stepPill");
  const savePill = document.getElementById("savePill");

  const state = { i: 0, data: {} };

  function setStepPill(){ stepPill.textContent = `Step ${state.i+1}/${steps.length}`; }
  function next(){ state.i = Math.min(state.i + 1, steps.length - 1); render(); }
  function save(key, value){ state.data[key] = value; }

  function makeVideoStage(videoUrl, titleHtml, bodyEl){
    const stage = document.createElement("div");
    stage.className = "stage";

    const vid = document.createElement("video");
    vid.autoplay = true;
    vid.muted = true;
    vid.loop = true;
    vid.playsInline = true;

    const src = document.createElement("source");
    src.src = videoUrl;
    src.type = "video/mp4";
    vid.appendChild(src);

    const shade = document.createElement("div");
    shade.className = "shade";

    const overlay = document.createElement("div");
    overlay.className = "overlay";

    const topBar = document.createElement("div");
    topBar.className = "topBar";

    const title = document.createElement("div");
    title.className = "title";
    title.innerHTML = titleHtml || "";
    topBar.appendChild(title);

    const bottomSheet = document.createElement("div");
    bottomSheet.className = "bottomSheet";

    const panel = document.createElement("div");
    panel.className = "panel";
    panel.appendChild(bodyEl);

    bottomSheet.appendChild(panel);

    overlay.appendChild(topBar);
    overlay.appendChild(bottomSheet);

    stage.appendChild(vid);
    stage.appendChild(shade);
    stage.appendChild(overlay);
    return stage;
  }

  function optionButton(code, label, onClick){
    const b = document.createElement("button");
    b.className = "btn";
    const row = document.createElement("div");
    row.className = "opt";

    const badge = document.createElement("span");
    badge.className = "badge";
    badge.textContent = code;

    const text = document.createElement("span");
    text.className = "label";
    text.textContent = label;

    row.appendChild(badge);
    row.appendChild(text);
    b.appendChild(row);
    b.onclick = onClick;
    return b;
  }

  function render(){
    setStepPill();
    app.innerHTML = "";
    const s = steps[state.i];

    if (s.type === "contact_form"){
      const wrap = document.createElement("div");
      wrap.className = "formCard";

      const t = document.createElement("div");
      t.className = "formTitle";
      t.textContent = s.title;
      wrap.appendChild(t);

      const grid = document.createElement("div");
      grid.className = "grid";
      const inputs = {};

      s.fields.forEach(f=>{
        const inp = document.createElement("input");
        inp.className = "input";
        inp.placeholder = f.placeholder;
        inp.value = state.data[f.key] || "";
        inp.oninput = ()=>{ inputs[f.key] = inp.value; };
        inputs[f.key] = inp.value;
        grid.appendChild(inp);
      });

      wrap.appendChild(grid);

      const btn = document.createElement("button");
      btn.className = "btn primary";
      btn.textContent = s.button;

      const msg = document.createElement("div");
      msg.className = "small";

      btn.onclick = ()=>{
        for (const f of s.fields){
          const v = (inputs[f.key] || "").trim();
          if (f.required && !v){
            msg.textContent = `Veuillez remplir: ${f.label}`;
            return;
          }
          save(f.key, v);
        }
        msg.textContent = "";
        next();
      };

      wrap.appendChild(btn);
      wrap.appendChild(msg);
      app.appendChild(wrap);
      return;
    }

    if (s.type === "video_button"){
      const body = document.createElement("div");
      body.className = "choices";

      const b = document.createElement("button");
      b.className = "btn primary";
      b.textContent = s.button;
      b.onclick = ()=> next();

      body.appendChild(b);
      app.appendChild(makeVideoStage(s.video, s.title, body));
      return;
    }

    if (s.type === "video_choices"){
      const body = document.createElement("div");
      body.className = "choices";

      s.choices.forEach(([code,label])=>{
        body.appendChild(optionButton(code, label, ()=>{ save(s.key, label); next(); }));
      });

      app.appendChild(makeVideoStage(s.video, s.title, body));
      return;
    }

    if (s.type === "video_input"){
      const body = document.createElement("div");
      body.className = "choices";

      let inp;
      if (s.multiline){
        inp = document.createElement("textarea");
        inp.rows = 3;
        inp.style.resize = "none";
      } else {
        inp = document.createElement("input");
      }
      inp.className = "input";
      inp.placeholder = s.placeholder || "";
      inp.value = state.data[s.key] || "";

      const btn = document.createElement("button");
      btn.className = "btn primary";
      btn.textContent = "Continuer";

      const msg = document.createElement("div");
      msg.className = "small";

      btn.onclick = ()=>{
        const v = (inp.value || "").trim();
        if (!v){ msg.textContent = "Veuillez remplir ce champ."; return; }
        save(s.key, v);
        next();
      };

      body.appendChild(inp);
      body.appendChild(btn);
      body.appendChild(msg);

      app.appendChild(makeVideoStage(s.video, s.title, body));
      return;
    }

    if (s.type === "video_choices_ok"){
      const body = document.createElement("div");
      body.className = "choices";

      let selected = state.data[s.key] || "";

      const okBtn = document.createElement("button");
      okBtn.className = "okBtn";
      okBtn.textContent = "OK";

      const msg = document.createElement("div");
      msg.className = "small";

      s.choices.forEach(([code,label])=>{
        body.appendChild(optionButton(code, label, ()=>{
          selected = label;
          save(s.key, label);

          okBtn.style.display = "block";       // âœ… ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø±
          msg.textContent = "Appuie sur OK pour envoyer âœ…";
        }));
      });

      okBtn.onclick = async ()=>{
        if (!selected){
          msg.textContent = "Choisis une option d'abord.";
          return;
        }
        okBtn.disabled = true;
        okBtn.textContent = "Envoi...";
        await submitAll();
        okBtn.textContent = "EnvoyÃ© âœ…";
      };

      body.appendChild(okBtn);
      body.appendChild(msg);

      app.appendChild(makeVideoStage(s.video, s.title, body));
      return;
    }
  }

  async function submitAll(){
    const payload = { ...state.data, submittedAt: new Date().toISOString(), flow: "videoask-like" };
    localStorage.setItem("video_form_last", JSON.stringify(payload));

    if (!WEBHOOK_URL){
      savePill.textContent = "Saved locally âœ…";
      return;
    }

    savePill.textContent = "Sending...";
    try{
      const res = await fetch(WEBHOOK_URL, {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify(payload)
      });
      if (!res.ok) throw new Error("Webhook error");
      savePill.textContent = "Sent âœ…";
    }catch(e){
      savePill.textContent = "Failed âŒ";
    }
  }

  render();
</script>
</body>
</html>
